# Reproducible Research: Peer Assessment 1


## Loading and preprocessing the data


```r
data <- read.csv(file = "activity.csv", colClasses = c("integer", "Date", "integer"))
attach(data)
summary(data)
```

## What is mean total number of steps taken per day?

```r
stepsPerDay <- aggregate(steps ~ date, data, sum, na.rm = TRUE)$steps
hist(stepsPerDay)
```

![plot of chunk unnamed-chunk-2](figure/unnamed-chunk-2.png) 


The Mean number of steps per day is:

```r
mean(stepsPerDay)
```

```
## [1] 10766
```


The Median number of steps per day is:

```r
median(stepsPerDay)
```

```
## [1] 10765
```

## What is the average daily activity pattern?
Time series plot of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)
```r
stepsByInterval <- aggregate(steps ~ interval, data, mean)
plot(stepsByInterval$steps, type = "l",xlab ="Interval", ylab="Average daily steps")
```

![plot of chunk unnamed-chunk-5](figure/unnamed-chunk-5.png) 

The highest mean steps and the interval with the maximum number of steps

```r
maxInterval = which.max(stepsByInterval$steps)
maxInterval
stepsByInterval$interval[maxInterval]
stepsByInterval$steps[maxInterval]
```

```
## [1] 104
```
```
## The interval: 835
```
```
## highest steps on average: 206.1698
```

## Imputing missing values

Number of missing rows

```r
missingRows<-sum(is.na(steps))
missingRows
```

```
## [1] 2304
```

Strategy for filling in all of the missing values:
Create new dataset with the missing values filled in with the average number of steps from the corresponding interval. 

```r
newdata<-data

for (i in 1:length(newdata$interval)) {
    if(is.na(newdata$steps[i])){
    newdata$steps[i] <- stepsByInterval[which(stepsByInterval$interval == newdata$interval[i]), ]$steps
    }
    else
    newdata$steps[i] <-newdata$steps[i]
}
```
Histogram of total number of steps per day with missing data filled in

```r
NewStepsPerDay <- aggregate(steps ~ date, newdata, sum)$steps
hist(NewStepsPerDay)
```

![plot of chunk unnamed-chunk-10](figure/unnamed-chunk-10.png) 


New mean with missing data filled in

```r
mean(NewStepsPerDay)
```

```
## [1] 10766.19
```


New median with missing data filled in

```r
median(NewStepsPerDay)
```

```
## [1] 10766.19
```

The values are almost the same with the data filled in.



## Are there differences in activity patterns between weekdays and weekends?
